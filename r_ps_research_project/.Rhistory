install.packages("PHEindicatormethods")
install.packages("dplyr")
library(PHEindicatormethods)
library(dplyr)
# csv file reading
database_filename <- "final_datasets/Finland_combined__years_with_nan_dropped_True_born_sum.csv"
database <- read.csv(database_filename, header = TRUE, sep = ",")
# print first 20 rows
head(database, 20)
years_list <- unique(database$Year)
year_test <- years_list[1]
# iterate over each year in Year column
for (year in year_test) {
# select rows with current year
current_year_data <- database[database$Year == year, ]
# print(current_year_data)
# sum up Values and Deaths for Rural Female, Rural Male, Urban Male, Urban Female separetlly for each age group
current_year_data_summarized <- current_year_data %>%
group_by(Age) %>%
summarise(Value = sum(Value), Deaths = sum(Deaths))
print(current_year_data_summarized)
life_expectancy <- phe_life_expectancy(
data = current_year_data_summarized,
deaths = Deaths,
population = Value,
startage = Age,
age_contents = c(
"0 - 4", "5 - 9",
"10 - 14", "15 - 19",
"20 - 24", "25 - 29",
"30 - 34", "35 - 39",
"40 - 44", "45 - 49",
"50 - 54", "55 - 59",
"60 - 64", "65 - 69",
"70 - 74", "75 - 79",
"80 +"
),
le_age = "all",
type = "full",
confidence = 0.95
)
print(life_expectancy)
}
# test
## Unordered age bands example
df <- data.frame(
startage = c(
"0", "1-4", "5-9", "10 - 14", "15 - 19", "20 - 24", "25 - 29",
"30 - 34", "35 - 39", "40 - 44", "45 - 49", "50 - 54",
"55 - 59", "60 - 64", "65 - 69", "75 - 79", "80 - 84",
"85 - 89", "90 +", "70 - 74"
),
pops = c(
7060L, 35059L, 46974L, 48489L, 43219L, 38561L, 46009L, 57208L,
61435L, 55601L, 50209L, 56416L, 46411L, 39820L, 37039L,
23306L, 11936L, 11936L, 37978L, 33288L
),
deaths = c(
17L, 9L, 4L, 8L, 20L, 15L, 24L, 33L, 50L, 71L, 100L, 163L,
263L, 304L, 872L, 1605L, 1936L, 1937L, 536L, 1390L
)
)
phe_life_expectancy(df, deaths, pops, startage,
age_contents = c(
"0", "1-4", "5-9",
"10 - 14", "15 - 19",
"20 - 24", "25 - 29",
"30 - 34", "35 - 39",
"40 - 44", "45 - 49",
"50 - 54", "55 - 59",
"60 - 64", "65 - 69",
"70 - 74", "75 - 79",
"80 - 84", "85 - 89",
"90 +"
)
)
# library(PHEindicatormethods)
source("r_libraries/phe_life_expectancy.r")
library(dplyr)
# csv file reading
database_filename <- "final_datasets/Finland_combined__years_with_nan_dropped_True_born_sum.csv"
database <- read.csv(database_filename, header = TRUE, sep = ",")
# print first 20 rows
head(database, 20)
years_list <- unique(database$Year)
year_test <- years_list[0]
# iterate over each year in Year column
for (year in year_test) {
# select rows with current year
current_year_data <- database[database$Year == year, ]
# print(current_year_data)
# sum up Values and Deaths for Rural Female, Rural Male, Urban Male, Urban Female separetlly for each age group
current_year_data_summarized <- current_year_data %>%
group_by(Age) %>%
summarise(Value = sum(Value), Deaths = sum(Deaths))
print(current_year_data_summarized)
life_expectancy <- phe_life_expectancy(
data = current_year_data_summarized,
deaths = Deaths,
population = Value,
startage = Age,
age_contents = c(
"0 - 4", "5 - 9",
"10 - 14", "15 - 19",
"20 - 24", "25 - 29",
"30 - 34", "35 - 39",
"40 - 44", "45 - 49",
"50 - 54", "55 - 59",
"60 - 64", "65 - 69",
"70 - 74", "75 - 79",
"80 +"
),
le_age = "all",
type = "full",
confidence = 0.95
)
print(life_expectancy)
}
# library(PHEindicatormethods)
source("r_libraries/phe_life_expectancy.r")
library(dplyr)
# csv file reading
database_filename <- "final_datasets/Finland_combined__years_with_nan_dropped_True_born_sum.csv"
database <- read.csv(database_filename, header = TRUE, sep = ",")
# print first 20 rows
head(database, 20)
years_list <- unique(database$Year)
year_test <- years_list[0]
print(year_test)
# iterate over each year in Year column
for (year in year_test) {
# select rows with current year
current_year_data <- database[database$Year == year, ]
# print(current_year_data)
# sum up Values and Deaths for Rural Female, Rural Male, Urban Male, Urban Female separetlly for each age group
current_year_data_summarized <- current_year_data %>%
group_by(Age) %>%
summarise(Value = sum(Value), Deaths = sum(Deaths))
print(current_year_data_summarized)
# life_expectancy <- phe_life_expectancy(
#     data = current_year_data_summarized,
#     deaths = Deaths,
#     population = Value,
#     startage = Age,
#     age_contents = c(
#         "0 - 4", "5 - 9",
#         "10 - 14", "15 - 19",
#         "20 - 24", "25 - 29",
#         "30 - 34", "35 - 39",
#         "40 - 44", "45 - 49",
#         "50 - 54", "55 - 59",
#         "60 - 64", "65 - 69",
#         "70 - 74", "75 - 79",
#         "80 +"
#     ),
#     le_age = "all",
#     type = "full",
#     confidence = 0.95
# )
# print(life_expectancy)
}
# print first 20 rows
head(database, 30)
# print first 20 rows
head(database, 100)
years_list <- unique(database$Year)
print(years_list)
year_test <- years_list[0]
print(year_test)
# iterate over each year in Year column
for (year in year_test) {
# select rows with current year
current_year_data <- database[database$Year == year, ]
# print(current_year_data)
# sum up Values and Deaths for Rural Female, Rural Male, Urban Male, Urban Female separetlly for each age group
current_year_data_summarized <- current_year_data %>%
group_by(Age) %>%
summarise(Value = sum(Value), Deaths = sum(Deaths))
print(current_year_data_summarized)
# life_expectancy <- phe_life_expectancy(
#     data = current_year_data_summarized,
#     deaths = Deaths,
#     population = Value,
#     startage = Age,
#     age_contents = c(
#         "0 - 4", "5 - 9",
#         "10 - 14", "15 - 19",
#         "20 - 24", "25 - 29",
#         "30 - 34", "35 - 39",
#         "40 - 44", "45 - 49",
#         "50 - 54", "55 - 59",
#         "60 - 64", "65 - 69",
#         "70 - 74", "75 - 79",
#         "80 +"
#     ),
#     le_age = "all",
#     type = "full",
#     confidence = 0.95
# )
# print(life_expectancy)
}
years_list <- unique(database$Year)
print(years_list)
year_test <- years_list[1]
print(year_test)
# iterate over each year in Year column
for (year in year_test) {
# select rows with current year
current_year_data <- database[database$Year == year, ]
# print(current_year_data)
# sum up Values and Deaths for Rural Female, Rural Male, Urban Male, Urban Female separetlly for each age group
current_year_data_summarized <- current_year_data %>%
group_by(Age) %>%
summarise(Value = sum(Value), Deaths = sum(Deaths))
print(current_year_data_summarized)
# life_expectancy <- phe_life_expectancy(
#     data = current_year_data_summarized,
#     deaths = Deaths,
#     population = Value,
#     startage = Age,
#     age_contents = c(
#         "0 - 4", "5 - 9",
#         "10 - 14", "15 - 19",
#         "20 - 24", "25 - 29",
#         "30 - 34", "35 - 39",
#         "40 - 44", "45 - 49",
#         "50 - 54", "55 - 59",
#         "60 - 64", "65 - 69",
#         "70 - 74", "75 - 79",
#         "80 +"
#     ),
#     le_age = "all",
#     type = "full",
#     confidence = 0.95
# )
# print(life_expectancy)
}
# print first 20 rows
head(database, 100)
